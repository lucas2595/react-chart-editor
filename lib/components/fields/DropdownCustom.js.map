{"version":3,"sources":["../../../src/components/fields/DropdownCustom.js"],"names":["UnconnectedDropdownCustom","props","context","setValue","bind","setLocals","state","custom","value","customOpt","options","map","o","includes","fullValue","undefined","MULTI_VALUED_PLACEHOLDER","defaultOpt","setState","updateContainer","attr","backgroundDark","clearable","components","placeholder","Component","propTypes","PropTypes","bool","any","updatePlot","func","object","oneOfType","number","string","label","Field","contextTypes","displayName"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport {connectToContainer} from 'lib';\nimport {MULTI_VALUED_PLACEHOLDER} from 'lib/constants';\nimport Field from './Field';\nimport DropdownWidget from '../widgets/Dropdown';\nimport Text from './Text';\n\nexport class UnconnectedDropdownCustom extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.setValue = this.setValue.bind(this);\n    this.setLocals = this.setLocals.bind(this);\n\n    this.setLocals(props);\n\n    this.state = {\n      custom:\n        this.value === props.customOpt ||\n        !this.props.options.map((o) => o.value).includes(this.value),\n    };\n  }\n\n  UNSAFE_componentWillReceiveProps(props) {\n    this.setLocals(props);\n  }\n\n  setLocals(props) {\n    this.value =\n      props.fullValue === undefined || props.fullValue === MULTI_VALUED_PLACEHOLDER // eslint-disable-line no-undefined\n        ? this.props.defaultOpt\n        : props.fullValue;\n  }\n\n  setValue(value, custom = false) {\n    this.value = value;\n    const customOpt = this.props.customOpt;\n    this.setState({\n      custom: (custom || value === customOpt) && value !== '',\n    });\n    this.props.updateContainer({\n      [this.props.attr]: value === customOpt && !custom ? customOpt : value,\n    });\n  }\n\n  render() {\n    const {options, attr, customOpt} = this.props;\n    const value =\n      (this.value === '' || !options.map((o) => o.value).includes(this.value)) && this.state.custom\n        ? customOpt\n        : this.value;\n\n    return (\n      <Field {...this.props}>\n        <DropdownWidget\n          backgroundDark={this.props.backgroundDark}\n          options={options}\n          value={value}\n          onChange={this.setValue}\n          clearable={this.props.clearable}\n          components={this.props.components}\n          placeholder={this.props.placeholder}\n        />\n\n        {this.state.custom && (\n          <Text\n            attr={attr}\n            updatePlot={(value) => this.setValue(value, true)}\n            onChange={(value) => {\n              if (value) {\n                this.setValue(value, true);\n              }\n            }}\n          />\n        )}\n      </Field>\n    );\n  }\n}\n\nUnconnectedDropdownCustom.propTypes = {\n  backgroundDark: PropTypes.bool,\n  fullValue: PropTypes.any,\n  updatePlot: PropTypes.func,\n  clearable: PropTypes.bool,\n  components: PropTypes.object,\n  placeholder: PropTypes.any,\n  defaultOpt: PropTypes.oneOfType([PropTypes.number, PropTypes.bool, PropTypes.string]),\n  customOpt: PropTypes.oneOfType([PropTypes.number, PropTypes.bool, PropTypes.string]),\n  label: PropTypes.string,\n  attr: PropTypes.string,\n  ...Field.propTypes,\n};\n\nUnconnectedDropdownCustom.contextTypes = {\n  updateContainer: PropTypes.func,\n};\n\nUnconnectedDropdownCustom.displayName = 'UnconnectedDropdownCustom';\n\nexport default connectToContainer(UnconnectedDropdownCustom);\n"],"file":"DropdownCustom.js"}